# FlatWiki v0.8.0

Release-Datum: 21.02.2026

## Zusammenfassung

v0.8.0 bringt Security-Härtung und robustere Schreibpfade für die Wiki-Dateien.  
Der Fokus liegt auf atomaren Operationen bei Seiten-Änderungen und klarer Trennung kryptografischer Schlüssel für Inhalte vs. Secret-Storage.

## Highlights

- Atomare Wiki-Schreibpfade aktiv im produktiven Pfad
  - Speichern und Restore schreiben über atomare `.tmp -> rename`-Operationen
  - Löschen nutzt den atomaren Delete-Pfad für Primärdateien
  - Raw-Reads des Primärpfads laufen über den atomaren Reader
- Key-Separation für Secret-Storage
  - Neuer Schlüssel: `SECRET_ENCRYPTION_KEY`
  - Secrets (z. B. SMTP-Passwort, User-E-Mail) sind getrennt von Artikel-Verschlüsselung
  - Kompatibilitäts-Fallback auf `CONTENT_ENCRYPTION_KEY` bleibt für Bestandsdaten erhalten
- Zusätzliche Backup-Härtung
  - `BACKUP_ENCRYPTION_KEY` darf nicht identisch mit `SECRET_ENCRYPTION_KEY` sein
- Doku und Setup-Hinweise aktualisiert
  - `config.env.example` erweitert
  - README um Schlüsseltrennung ergänzt
  - Setup-Hinweistext aktualisiert

## Sicherheit und Integrität

- Concurrency-Schutz für Primär-Schreibpfade verbessert (atomare Writes + serielle Schreibzugriffe pro Datei)
- Risiko von teilweise geschriebenen Markdown-Dateien bei Absturz/Parallelität reduziert
- Secret-Verschlüsselung und Content-Verschlüsselung sind nun klar getrennt

## Kompatibilität / Migration

- Bestehende Installationen bleiben kompatibel:
  - Ist `SECRET_ENCRYPTION_KEY` nicht gesetzt, wird automatisch `CONTENT_ENCRYPTION_KEY` als Fallback genutzt
  - Legacy-Secrets bleiben lesbar (Decrypt-Fallback)
- Empfehlung für Produktion:
  - `SECRET_ENCRYPTION_KEY` als eigenen 64-hex Schlüssel setzen
  - Schlüssel nach produktivem Einsatz nicht mehr wechseln

## Empfohlene Checks nach Release

1. `docker compose up -d --build` ausführen
2. Login + Artikel speichern/bearbeiten + Restore testen
3. SMTP-Konfiguration speichern und Testmail senden
4. Prüfen, dass `SECRET_ENCRYPTION_KEY` in `config.env` gesetzt ist (empfohlen)

## Tag

- `v0.8.0`
